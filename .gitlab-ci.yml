image: node:8.11.3

staging:
  stage: deploy
  script:
    - yarn
    - yarn build
    - mkdir ~/.ssh
    - touch ~/.ssh/known_hosts
    - echo "github.com,192.30.253.112 ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAq2A7hRGmdnm9tUDbO9IDSwBK6TbQa+PXYPCPy6rbTrTtw7PHkccKrpp0yVhp5HdEIcKr6pLlVDBfOLX9QUsyCOV0wzfjIJNlGEYsdlLJizHhbn2mUjvSAHQqZETYP81eFzLQNnPHt4EVVUh7VfDESU84KezmD5QlWpXLmvU31/yMf+Se8xhHTvKSCZIFImWwoG6mbUoWf9nzpIoaSjB+weqqUUmpaaasXVal72J+UX2B+2RPW3RcT0eOzQgqlJL3RKrTJvdsjE3JEAvGq3lGHSZXy28G3skua2SmVi/w4yCE6gbODqnTWlg7+wC604ydGXA8VJiS5ap43JXiUFFAaQ==" > ~/.ssh/known_hosts
    - git checkout master
    - git checkout dev
    - git remote rm origin
    - git remote add origin git@gitlab.com:manuscript/surix/app-service.git
    - git add .
    - git config --global user.email "nderitukelvin19@gmail.com"
    - git config --global user.name "CI"
    - git commit -m 'Production Build...'
    - git push origin dev
  only:
  - dev
